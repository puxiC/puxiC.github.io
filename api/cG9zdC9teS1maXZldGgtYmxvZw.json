{"title":"用Aria+AriaNg+rclone+gdrive实现满速下载上传gdrive","date":"2019-07-28T10:41:45.000Z","link":"post/my-fiveth-blog","updated":"2019-07-28T11:32:56.098Z","content":"<h4 id=\"优点：\">优点：<a href=\"post/my-fiveth-blog#优点：\"></a></h4><ul>\n<li>满速下载bt，不用迅雷不会出现资源无法下载的问题</li>\n<li>自动上传gdrive，更加省心</li>\n<li>也可以使用rclone进行不同网盘之间同步文件，虽然不支持百度网盘，但是onedrive。gdrive。mega……都可以</li>\n</ul>\n<a id=\"more\"></a>\n\n<h4 id=\"参考链接：\">参考链接：<a href=\"post/my-fiveth-blog#参考链接：\"></a></h4><blockquote>\n<p><a href=\"https://blog.codesofun.com/ariang-rclone-for-google-drive-offline-download.html\" target=\"_blank\" rel=\"noopener\">https://blog.codesofun.com/ariang-rclone-for-google-drive-offline-download.html</a><br><a href=\"https://blog.codesofun.com/aria2-rclone-faq.html\" target=\"_blank\" rel=\"noopener\">https://blog.codesofun.com/aria2-rclone-faq.html</a><br><a href=\"http://www.yuzhiwei.com.cn/archives/239.html\" target=\"_blank\" rel=\"noopener\">http://www.yuzhiwei.com.cn/archives/239.html</a><br>可能还有但是我没加入收藏，暂时找不到，但是都是互相看的差别不大，只是一些细节问题，我会注明</p>\n</blockquote>\n<h5 id=\"首先条件\">首先条件<a href=\"post/my-fiveth-blog#首先条件\"></a></h5><ol>\n<li>vps 我的是centOS7，KVM,15g内存，1T流量，用的是<a href=\"https://billing.virmach.com/clientarea.php?action=productdetails&id=386812\" title=\"这家的\" target=\"_blank\" rel=\"noopener\">这家的</a>，最低的套餐卖完了就买的2.5美金一个月的，<a href=\"https://www.zhujiceping.com/35177.html\" title=\"优惠码\" target=\"_blank\" rel=\"noopener\">优惠码</a>，<a href=\"https://blog.csdn.net/qq_42237101/article/details/80363986\" title=\"速度测试\" target=\"_blank\" rel=\"noopener\">速度测试</a></li>\n<li>gdrive账号~</li>\n</ol>\n<p>安装nginx web服务器</p>\n<figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum -y update</span><br><span class=\"line\">yum -y install epel-release</span><br><span class=\"line\">yum -y install wget git unzip gcc gcc-c++ openssl-devel nginx</span><br></pre></td></tr></table></div></figure>\n\n<p>启动nginx并设置开机自启</p>\n<figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl start nginx</span><br><span class=\"line\">systemctl enable nginx.service</span><br><span class=\"line\">systemctl stop firewalld # 关闭防火墙</span><br></pre></td></tr></table></div></figure>\n\n<p>这个时候可以访问服务器的外网IP查看nginx启动成功。启动成功会显示一个nginx的页面。</p>\n<h3 id=\"安装aria2\">#### 安装aria2<a href=\"post/my-fiveth-blog#安装aria2\"></a></h3><p>安装aria2服务端，使用逗比大佬的脚本</p>\n<figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget -N --no-check-certificate https://raw.githubusercontent.com/ToyoDAdoubi/doubi/master/aria2.sh &amp;&amp; chmod +x aria2.sh &amp;&amp; bash aria2.sh</span><br></pre></td></tr></table></div></figure>\n\n<p>输入1安装，修改下载目录</p>\n<figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir -p /data/Download</span><br></pre></td></tr></table></div></figure>\n\n<h5 id=\"快捷操作\">快捷操作<a href=\"post/my-fiveth-blog#快捷操作\"></a></h5><ul>\n<li>启动：/etc/init.d/aria2 start</li>\n<li>停止：/etc/init.d/aria2 stop</li>\n<li>重启：/etc/init.d/aria2 restart</li>\n<li>查看状态：/etc/init.d/aria2 status</li>\n<li>配置文件:( /root/.aria2/aria2.conf配置文件包含中文注释，但是一些系统可能不支持显示中文）</li>\n<li>令牌密匙：随机生成（可以自己修改配置文件）</li>\n<li>下载目录：/data/Download</li>\n</ul>\n<h3 id=\"安装AriaNg\">安装AriaNg<a href=\"post/my-fiveth-blog#安装AriaNg\"></a></h3><blockquote>\n<p>Github源码地址：https：//github.com/mayswind/AriaNg</p>\n</blockquote>\n<p>下载AriaNg</p>\n<figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mkdir -p /data/www/ariang</span><br><span class=\"line\">cd /data/www/ariang</span><br><span class=\"line\">wget https://github.com/mayswind/AriaNg-DailyBuild/archive/master.zip &amp;&amp; unzip master.zip</span><br><span class=\"line\">mv AriaNg-DailyBuild-master/* .</span><br><span class=\"line\">rm -rf master.zip AriaNg-DailyBuild-master</span><br></pre></td></tr></table></div></figure>\n\n<p>配置Nginx虚拟主机</p>\n<figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">yum install vim #安装vim编辑器</span><br><span class=\"line\">cd /etc/nginx/conf.d</span><br><span class=\"line\">touch ariang.conf</span><br><span class=\"line\">vim ariang.conf #使用编辑</span><br></pre></td></tr></table></div></figure>\n\n<p>nginx配置（注意一定要对照一下，有时候可能粘贴不全）</p>\n<figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen 80;</span><br><span class=\"line\">    server_name &lt;ip&gt;;  #&lt;ip&gt;填上自己vps的ip地址</span><br><span class=\"line\">    location / &#123;</span><br><span class=\"line\">        root   /data/www/ariang;</span><br><span class=\"line\">        index  index.html index.htm;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></div></figure>\n\n<p>现在可以使用nginx -t测试一下配置文件是否修改正确</p>\n<h5 id=\"重新加载nginx配置\">重新加载nginx配置<a href=\"post/my-fiveth-blog#重新加载nginx配置\"></a></h5><figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl reload nginx</span><br></pre></td></tr></table></div></figure>\n\n<p>在浏览器打开ip地址就能看到效果啦。</p>\n<h5 id=\"如果出现了问题，看下面\">如果出现了问题，看下面<a href=\"post/my-fiveth-blog#如果出现了问题，看下面\"></a></h5><ul>\n<li><p>如果是一直转圈圈加载不出来，尝试关闭防火墙再试试 </p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">systemctl stop firewalld</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>浏览器访问 ip 出现 403</p>\n</li>\n</ul>\n<p><strong>权限不够</strong></p>\n<p>解决方法 </p>\n<figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chmod -R 755 /data/www</span><br></pre></td></tr></table></div></figure>\n\n<p><strong>开启了 SELinux</strong></p>\n<p>使用 <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/usr/sbin/sestatus -v</span><br><span class=\"line\">``` 查看是否开启，输出 enable 则为开启。</span><br><span class=\"line\"></span><br><span class=\"line\">解决方法```shell</span><br><span class=\"line\"> vim /etc/selinux/config</span><br><span class=\"line\">``` 将 SELINUX=enforcing 改为```shell</span><br><span class=\"line\"> SELINUX=disabled</span><br><span class=\"line\">```，然后使用 reboot重启系统。</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span>## 挂载Google Drive到VPS</span><br><span class=\"line\"><span class=\"meta\">#</span>#### 安装rclone</span><br><span class=\"line\"></span><br><span class=\"line\">```shell</span><br><span class=\"line\">yum -y install unzip</span><br><span class=\"line\">curl https://rclone.org/install.sh | sudo bash</span><br></pre></td></tr></table></figure></p>\n<p>配置</p>\n<figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@vultr ~]# rclone config</span><br><span class=\"line\">2018/11/25 09:31:54 NOTICE: Config file \"/root/.config/rclone/rclone.conf\" not found - using defaults</span><br><span class=\"line\">No remotes found - make a new one</span><br><span class=\"line\">n) New remote</span><br><span class=\"line\">s) Set configuration password</span><br><span class=\"line\">q) Quit config</span><br><span class=\"line\">n/s/q&gt; n</span><br><span class=\"line\"><span class=\"meta\">name&gt;</span> codesofun</span><br><span class=\"line\">Type of storage to configure.</span><br><span class=\"line\">Enter a string value. Press Enter for the default (\"\").</span><br><span class=\"line\">Choose a number from below, or type in your own value</span><br><span class=\"line\"> 1 / A stackable unification remote, which can appear to merge the contents of several remotes</span><br><span class=\"line\">   \\ \"union\"</span><br><span class=\"line\"> 2 / Alias for a existing remote</span><br><span class=\"line\">   \\ \"alias\"</span><br><span class=\"line\"> 3 / Amazon Drive</span><br><span class=\"line\">   \\ \"amazon cloud drive\"</span><br><span class=\"line\"> 4 / Amazon S3 Compliant Storage Providers (AWS, Ceph, Dreamhost, IBM COS, Minio)</span><br><span class=\"line\">   \\ \"s3\"</span><br><span class=\"line\"> 5 / Backblaze B2</span><br><span class=\"line\">   \\ \"b2\"</span><br><span class=\"line\"> 6 / Box</span><br><span class=\"line\">   \\ \"box\"</span><br><span class=\"line\"> 7 / Cache a remote</span><br><span class=\"line\">   \\ \"cache\"</span><br><span class=\"line\"> 8 / Dropbox</span><br><span class=\"line\">   \\ \"dropbox\"</span><br><span class=\"line\"> 9 / Encrypt/Decrypt a remote</span><br><span class=\"line\">   \\ \"crypt\"</span><br><span class=\"line\">10 / FTP Connection</span><br><span class=\"line\">   \\ \"ftp\"</span><br><span class=\"line\">11 / Google Cloud Storage (this is not Google Drive)</span><br><span class=\"line\">   \\ \"google cloud storage\"</span><br><span class=\"line\">12 / Google Drive</span><br><span class=\"line\">   \\ \"drive\"</span><br><span class=\"line\">13 / Hubic</span><br><span class=\"line\">   \\ \"hubic\"</span><br><span class=\"line\">14 / JottaCloud</span><br><span class=\"line\">   \\ \"jottacloud\"</span><br><span class=\"line\">15 / Local Disk</span><br><span class=\"line\">   \\ \"local\"</span><br><span class=\"line\">16 / Mega</span><br><span class=\"line\">   \\ \"mega\"</span><br><span class=\"line\">17 / Microsoft Azure Blob Storage</span><br><span class=\"line\">   \\ \"azureblob\"</span><br><span class=\"line\">18 / Microsoft OneDrive</span><br><span class=\"line\">   \\ \"onedrive\"</span><br><span class=\"line\">19 / OpenDrive</span><br><span class=\"line\">   \\ \"opendrive\"</span><br><span class=\"line\">20 / Openstack Swift (Rackspace Cloud Files, Memset Memstore, OVH)</span><br><span class=\"line\">   \\ \"swift\"</span><br><span class=\"line\">21 / Pcloud</span><br><span class=\"line\">   \\ \"pcloud\"</span><br><span class=\"line\">22 / QingCloud Object Storage</span><br><span class=\"line\">   \\ \"qingstor\"</span><br><span class=\"line\">23 / SSH/SFTP Connection</span><br><span class=\"line\">   \\ \"sftp\"</span><br><span class=\"line\">24 / Webdav</span><br><span class=\"line\">   \\ \"webdav\"</span><br><span class=\"line\">25 / Yandex Disk</span><br><span class=\"line\">   \\ \"yandex\"</span><br><span class=\"line\">26 / http Connection</span><br><span class=\"line\">   \\ \"http\"</span><br><span class=\"line\"><span class=\"meta\">Storage&gt;</span> 12</span><br><span class=\"line\">** See help for drive backend at: https://rclone.org/drive/ **</span><br><span class=\"line\"></span><br><span class=\"line\">Google Application Client Id</span><br><span class=\"line\">Leave blank normally.</span><br><span class=\"line\">Enter a string value. Press Enter for the default (\"\").</span><br><span class=\"line\"><span class=\"meta\">client_id&gt;</span></span><br><span class=\"line\">Google Application Client Secret</span><br><span class=\"line\">Leave blank normally.</span><br><span class=\"line\">Enter a string value. Press Enter for the default (\"\").</span><br><span class=\"line\"><span class=\"meta\">client_secret&gt;</span></span><br><span class=\"line\">Scope that rclone should use when requesting access from drive.</span><br><span class=\"line\">Enter a string value. Press Enter for the default (\"\").</span><br><span class=\"line\">Choose a number from below, or type in your own value</span><br><span class=\"line\"> 1 / Full access all files, excluding Application Data Folder.</span><br><span class=\"line\">   \\ \"drive\"</span><br><span class=\"line\"> 2 / Read-only access to file metadata and file contents.</span><br><span class=\"line\">   \\ \"drive.readonly\"</span><br><span class=\"line\">   / Access to files created by rclone only.</span><br><span class=\"line\"> 3 | These are visible in the drive website.</span><br><span class=\"line\">   | File authorization is revoked when the user deauthorizes the app.</span><br><span class=\"line\">   \\ \"drive.file\"</span><br><span class=\"line\">   / Allows read and write access to the Application Data folder.</span><br><span class=\"line\"> 4 | This is not visible in the drive website.</span><br><span class=\"line\">   \\ \"drive.appfolder\"</span><br><span class=\"line\">   / Allows read-only access to file metadata but</span><br><span class=\"line\"> 5 | does not allow any access to read or download file content.</span><br><span class=\"line\">   \\ \"drive.metadata.readonly\"</span><br><span class=\"line\"><span class=\"meta\">scope&gt;</span> 1</span><br><span class=\"line\">ID of the root folder</span><br><span class=\"line\">Leave blank normally.</span><br><span class=\"line\">Fill in to access \"Computers\" folders. (see docs).</span><br><span class=\"line\">Enter a string value. Press Enter for the default (\"\").</span><br><span class=\"line\"><span class=\"meta\">root_folder_id&gt;</span></span><br><span class=\"line\">Service Account Credentials JSON file path</span><br><span class=\"line\">Leave blank normally.</span><br><span class=\"line\">Needed only if you want use SA instead of interactive login.</span><br><span class=\"line\">Enter a string value. Press Enter for the default (\"\").</span><br><span class=\"line\"><span class=\"meta\">service_account_file&gt;</span></span><br><span class=\"line\">Edit advanced config? (y/n)</span><br><span class=\"line\">y) Yes</span><br><span class=\"line\">n) No</span><br><span class=\"line\">y/n&gt; n</span><br><span class=\"line\">Remote config</span><br><span class=\"line\">Use auto config?</span><br><span class=\"line\"> * Say Y if not sure</span><br><span class=\"line\"> * Say N if you are working on a remote or headless machine or Y didn't work</span><br><span class=\"line\">y) Yes</span><br><span class=\"line\">n) No</span><br><span class=\"line\">y/n&gt; n</span><br><span class=\"line\">If your browser doesn't open automatically go to the following link: https://accounts.google.com/o/oauth2/auth?access_type=offline&amp;client_id=202264815644.apps.googleusercontent.com&amp;redirect_uri=urn%3Aietf%3Awg%3Aoauth%3A2.0%3Aoob&amp;response_type=code&amp;scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fdrive&amp;state=0fbdd**********************05a3b00e23</span><br><span class=\"line\">Log in and authorize rclone for access</span><br><span class=\"line\">Enter verification code&gt; 4/owSACseTxM*************c2HtEVX_yEhBcr--JiFTA7-Pfg</span><br><span class=\"line\"></span><br><span class=\"line\">Configure this as a team drive?</span><br><span class=\"line\">y) Yes</span><br><span class=\"line\">n) No</span><br><span class=\"line\">y/n&gt; n</span><br><span class=\"line\">Fetching team drive list...</span><br><span class=\"line\">No team drives found in your account--------------------</span><br><span class=\"line\">[codesofun]</span><br><span class=\"line\">type = drive</span><br><span class=\"line\">scope = drive</span><br><span class=\"line\">token = &#123;\"access_token\":\"ya29.GltfBn_YA8e0lgJNKeMAHZ3b_IeIBXHHrJxMO7wfW0AsY6v_Nso8YczhZafVe8UIIgK6ft1dn6BqP-UWp-W2YXBtcf6zbLuIZgKcPqwnhsVAkx3f7QcO5m0EUvAv\",\"token_type\":\"Bearer\",\"refresh_token\":\"1/hFSVnEeJ8CkFmrpdd7IGNx69mhkj8Cpny6JUktv3xcY\",\"expiry\":\"2018-11-25T10:42:09.400295503Z\"&#125;</span><br><span class=\"line\">--------------------</span><br><span class=\"line\">y) Yes this is OK</span><br><span class=\"line\">e) Edit this remote</span><br><span class=\"line\">d) Delete this remote</span><br><span class=\"line\">y/e/d&gt; y</span><br><span class=\"line\">Current remotes:</span><br><span class=\"line\"></span><br><span class=\"line\">Name                 Type</span><br><span class=\"line\">====                 ====</span><br><span class=\"line\">codesofun            drive</span><br><span class=\"line\"></span><br><span class=\"line\">e) Edit existing remote</span><br><span class=\"line\">n) New remote</span><br><span class=\"line\">d) Delete remote</span><br><span class=\"line\">r) Rename remote</span><br><span class=\"line\">c) Copy remote</span><br><span class=\"line\">s) Set configuration password</span><br><span class=\"line\">q) Quit config</span><br><span class=\"line\">e/n/d/r/c/s/q&gt; q</span><br></pre></td></tr></table></div></figure>\n\n<p>注意某些细节可能不同，比如选网盘的顺序<br>因为我用的方法是自动下载然后后面用命令rclone delete /data/Download 所以我的脚本和第二个不一样，自动删除文件我Aria下载会没有速度，总之第一种方法。</p>\n<h5 id=\"挂载磁盘\">挂载磁盘<a href=\"post/my-fiveth-blog#挂载磁盘\"></a></h5><figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span> 新建本地文件夹，路径自己定</span><br><span class=\"line\">mkdir -p /data/GoogleDrive</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span> 挂载为磁盘</span><br><span class=\"line\">rclone mount codesofun:share /data/GoogleDrive --allow-other --allow-non-empty --vfs-cache-mode writes &amp;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span>格式为[name]:[google drive dir] [mount dir]</span><br><span class=\"line\"><span class=\"meta\">#</span>[name]就是配置文件是输入的name，例如我的就是ct</span><br><span class=\"line\"><span class=\"meta\">#</span>[google drive dir] 这个是谷歌云盘的目录，根目录的花直接空开就可以了</span><br><span class=\"line\"><span class=\"meta\">#</span>[mount dir]就是本地挂载位置，/data/GoogleDrive</span><br></pre></td></tr></table></div></figure>\n\n<blockquote>\n<p>致命错误：无法挂载FUSE fs：fusermount：exec：“fusermount”：$ PATH中找不到可执行文件<br>没有安装保险丝，自行安装就可以了 yum -y install fuse</p>\n</blockquote>\n<p>挂载后 df -h看下效果</p>\n<h5 id=\"设置开机自动挂载谷歌云\">设置开机自动挂载谷歌云<a href=\"post/my-fiveth-blog#设置开机自动挂载谷歌云\"></a></h5><figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">wget https://blog.codesofun.com/scripts/rcloned &amp;&amp; vim rcloned</span><br><span class=\"line\"><span class=\"meta\">#</span>然后修改文件内如下内容</span><br><span class=\"line\">NAME=\"\"  #[name]</span><br><span class=\"line\">REMOTE=''  #[google drive dir]</span><br><span class=\"line\">LOCAL=''  #[mount dir]</span><br></pre></td></tr></table></div></figure>\n\n<p>设置自启动</p>\n<figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mv rcloned /etc/init.d/rcloned</span><br><span class=\"line\">chmod +x /etc/init.d/rcloned</span><br><span class=\"line\">vim /etc/rc.d/rc.local #在末尾加入 bash /etc/init.d/rcloned start</span><br><span class=\"line\">chmod +x /etc/rc.d/rc.local</span><br><span class=\"line\"></span><br><span class=\"line\">bash /etc/init.d/rcloned status</span><br></pre></td></tr></table></div></figure>\n\n<p>然后可以在vps上生成文件测试一下啦~</p>\n<figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">cd /data/GoogleDrive</span><br><span class=\"line\">touch codesofun.txt</span><br></pre></td></tr></table></div></figure>\n\n<p>在google drive上刷新一下</p>\n<h4 id=\"整合Aria2-Rclone\">整合Aria2 + Rclone<a href=\"post/my-fiveth-blog#整合Aria2-Rclone\"></a></h4><figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /root/rcloneupload.sh</span><br></pre></td></tr></table></div></figure>\n\n<figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">#</span>!/bin/bash</span><br><span class=\"line\"></span><br><span class=\"line\">GID=\"$1\";</span><br><span class=\"line\">FileNum=\"$2\";</span><br><span class=\"line\">File=\"$3\";</span><br><span class=\"line\">MinSize=\"5\"  #限制最低上传大小，默认5k</span><br><span class=\"line\">MaxSize=\"157286400\"  #限制最高文件大小(单位k)，默认15G</span><br><span class=\"line\">RemoteDIR=\"/data/GoogleDrive/\";  #rclone挂载的本地文件夹，最后面保留/</span><br><span class=\"line\">LocalDIR=\"/data/Download/\";  #Aria2下载目录，最后面保留/</span><br><span class=\"line\"></span><br><span class=\"line\">if [[ -z $(echo \"$FileNum\" |grep -o '[0-9]*' |head -n1) ]]; then FileNum='0'; fi</span><br><span class=\"line\">if [[ \"$FileNum\" -le '0' ]]; then exit 0; fi</span><br><span class=\"line\">if [[ \"$#\" != '3' ]]; then exit 0; fi</span><br><span class=\"line\"></span><br><span class=\"line\">function LoadFile()&#123;</span><br><span class=\"line\">  IFS_BAK=$IFS</span><br><span class=\"line\">  IFS=$'\\n'</span><br><span class=\"line\">  if [[ ! -d \"$LocalDIR\" ]]; then return; fi</span><br><span class=\"line\">  if [[ -e \"$File\" ]]; then</span><br><span class=\"line\">    FileLoad=\"$&#123;File/#$LocalDIR&#125;\"</span><br><span class=\"line\">    while true</span><br><span class=\"line\">      do</span><br><span class=\"line\">        if [[ \"$FileLoad\" == '/' ]]; then return; fi</span><br><span class=\"line\">        echo \"$FileLoad\" |grep -q '/';</span><br><span class=\"line\">        if [[ \"$?\" == \"0\" ]]; then</span><br><span class=\"line\">          FileLoad=$(dirname \"$FileLoad\");</span><br><span class=\"line\">        else</span><br><span class=\"line\">          break;</span><br><span class=\"line\">        fi;</span><br><span class=\"line\">      done;</span><br><span class=\"line\">    if [[ \"$FileLoad\" == \"$LocalDIR\" ]]; then return; fi</span><br><span class=\"line\">    EXEC=\"$(command -v mv)\"</span><br><span class=\"line\">    if [[ -z \"$EXEC\" ]]; then return; fi</span><br><span class=\"line\">    Option=\" -f\";</span><br><span class=\"line\">    cd \"$LocalDIR\";</span><br><span class=\"line\">    if [[ -e \"$FileLoad\" ]]; then</span><br><span class=\"line\">      ItemSize=$(du -s \"$FileLoad\" |cut -f1 |grep -o '[0-9]*' |head -n1)</span><br><span class=\"line\">      if [[ -z \"$ItemSize\" ]]; then return; fi</span><br><span class=\"line\">      if [[ \"$ItemSize\" -le \"$MinSize\" ]]; then</span><br><span class=\"line\">        echo -ne \"\\033[33m$FileLoad \\033[0mtoo small to spik.\\n\";</span><br><span class=\"line\">        return;</span><br><span class=\"line\">      fi</span><br><span class=\"line\">      if [[ \"$ItemSize\" -ge \"$MaxSize\" ]]; then</span><br><span class=\"line\">        echo -ne \"\\033[33m$FileLoad \\033[0mtoo large to spik.\\n\";</span><br><span class=\"line\">        return;</span><br><span class=\"line\">      fi</span><br><span class=\"line\">      eval \"$&#123;EXEC&#125;$&#123;Option&#125;\" \\'\"$&#123;FileLoad&#125;\"\\' \"$&#123;RemoteDIR&#125;\";</span><br><span class=\"line\">      if [[ $? == '0' ]]; then</span><br><span class=\"line\">        rm -rf \"$FileLoad\";</span><br><span class=\"line\">      fi</span><br><span class=\"line\">    fi</span><br><span class=\"line\">  fi</span><br><span class=\"line\">  IFS=$IFS_BAK</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">LoadFile;</span><br></pre></td></tr></table></div></figure>\n\n<p>保存后授予权限</p>\n<figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">chmod +x /root/rcloneupload.sh</span><br></pre></td></tr></table></div></figure>\n\n<figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">vim /root/.aria2/aria2.conf</span><br><span class=\"line\"></span><br><span class=\"line\">on-download-complete=/root/rcloneupload.sh</span><br></pre></td></tr></table></div></figure>\n\n<figure class=\"highlight shell\"><div><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/etc/init.d/aria2 restart</span><br></pre></td></tr></table></div></figure>\n\n<p>就完成啦~~</p>\n<h4 id=\"如何两个网盘同步文件\">如何两个网盘同步文件<a href=\"post/my-fiveth-blog#如何两个网盘同步文件\"></a></h4><p>执行命令 <figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">rclone copy codesofun:share hello:share</span><br><span class=\"line\">``` 即可。</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">&gt;</span>rclone copy source:sourcepath dest:destpsth</span><br><span class=\"line\">rclone copy 复制总是指定路径下的数据；而不是当前目录。 –no-traverse 标志用于控制是否列出目的地址目录。</span><br><span class=\"line\">如果文件比较多或者较大的话建议使用 screen 命令开启一个会话执行，这里使用 share 目录的原因是一个习惯而已，不加目录就是整个网盘咯。</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">#</span>### rclone常用命令</span><br><span class=\"line\">```shell</span><br><span class=\"line\"><span class=\"meta\">#</span># 文件上传</span><br><span class=\"line\">rclone copy /home/backup gdrive:backup # 本地路径 配置名字:谷歌文件夹名字</span><br><span class=\"line\"><span class=\"meta\">#</span>## 文件下载</span><br><span class=\"line\">rclone copy gdrive:backup /home/backup</span><br><span class=\"line\"><span class=\"meta\">#</span>## 列表</span><br><span class=\"line\">rclone ls gdrive:backup</span><br><span class=\"line\">rclone lsl gdrive:backup # 比上面多一个显示上传时间</span><br><span class=\"line\">rclone lsd gdrive:backup # 只显示文件夹</span><br><span class=\"line\"><span class=\"meta\">#</span>## 新建文件夹</span><br><span class=\"line\">rclone mkdir gdrive:backup</span><br><span class=\"line\"><span class=\"meta\">#</span>## 挂载</span><br><span class=\"line\">rclone mount gdrive:mm /root/mm &amp;</span><br><span class=\"line\"><span class=\"meta\">#</span>## 卸载</span><br><span class=\"line\">fusermount -u  /root/mm</span><br><span class=\"line\"> </span><br><span class=\"line\"><span class=\"meta\">#</span>### 其他 ####</span><br><span class=\"line\"><span class=\"meta\">#</span>### https://softlns.github.io/2016/11/28/rclone-guide/</span><br><span class=\"line\">rclone config - 以控制会话的形式添加rclone的配置，配置保存在.rclone.conf文件中。</span><br><span class=\"line\">rclone copy - 将文件从源复制到目的地址，跳过已复制完成的。</span><br><span class=\"line\">rclone sync - 将源数据同步到目的地址，只更新目的地址的数据。   –dry-run标志来检查要复制、删除的数据</span><br><span class=\"line\">rclone move - 将源数据移动到目的地址。</span><br><span class=\"line\">rclone delete - 删除指定路径下的文件内容。</span><br><span class=\"line\">rclone purge - 清空指定路径下所有文件数据。</span><br><span class=\"line\">rclone mkdir - 创建一个新目录。</span><br><span class=\"line\">rclone rmdir - 删除空目录。</span><br><span class=\"line\">rclone check - 检查源和目的地址数据是否匹配。</span><br><span class=\"line\">rclone ls - 列出指定路径下所有的文件以及文件大小和路径。</span><br><span class=\"line\">rclone lsd - 列出指定路径下所有的目录/容器/桶。</span><br><span class=\"line\">rclone lsl - 列出指定路径下所有文件以及修改时间、文件大小和路径。</span><br><span class=\"line\">rclone md5sum - 为指定路径下的所有文件产生一个md5sum文件。</span><br><span class=\"line\">rclone sha1sum - 为指定路径下的所有文件产生一个sha1sum文件。</span><br><span class=\"line\">rclone size - 获取指定路径下，文件内容的总大小。.</span><br><span class=\"line\">rclone version - 查看当前版本。</span><br><span class=\"line\">rclone cleanup - 清空remote。</span><br><span class=\"line\">rclone dedupe - 交互式查找重复文件，进行删除/重命名操作。</span><br></pre></td></tr></table></figure></p>\n","next":{"title":"用vps搭建ssr","link":"post/my-fourth-blog"},"plink":"http://yoursite.com/post/my-fiveth-blog/"}